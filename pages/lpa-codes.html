<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>OPG Data</title>
	<meta name="description" content="">
	<meta name="author" content="Ministry of Justice">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="https://jamesrwarren.github.io/test_documentation/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="https://jamesrwarren.github.io/test_documentation/theme/bootstrap.min.css" rel="stylesheet">
	<link href="https://jamesrwarren.github.io/test_documentation/theme/local.css" rel="stylesheet">
	<link href="https://jamesrwarren.github.io/test_documentation/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->




</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="https://jamesrwarren.github.io/test_documentation/">OPG Data</a>
			<ul class="nav">
						<li><a href="https://jamesrwarren.github.io/test_documentation/pages/how-to-publish.html">How To Publish</a></li>
						<li><a href="https://jamesrwarren.github.io/test_documentation/pages/list-of-integrations.html">List of Integrations</a></li>
						<li><a href="https://jamesrwarren.github.io/test_documentation/pages/technologies-used.html">Technologies used</a></li>
						<li><a href="https://jamesrwarren.github.io/test_documentation/pages/the-team.html">The Team</a></li>
					<li ><a href="https://jamesrwarren.github.io/test_documentation/category/misc.html">misc</a></li>
			</ul>
			<p class="pull-right"><a href="https://jamesrwarren.github.io/test_documentation/archives.html">[archives]</a> <a href="https://jamesrwarren.github.io/test_documentation/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://github.com/ministryofjustice/opg-data">OPG Data</a></li>
				<li><a href="https://github.com/ministryofjustice/opg-data-deputy-reporting">OPG Data Deputy Reporting</a></li>
				<li><a href="https://github.com/ministryofjustice/opg-data-lpa-codes">OPG Data LPA Codes</a></li>
				<li><a href="http://getpelican.com/">Pelican</a></li>
				<li><a href="http://python.org/">Python.org</a></li>
				<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="https://www.publicguardian-scotland.gov.uk/general/contact-us">OPG Contact Us</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='page'>
		<div class="page-header"><h1>LPA Codes</h1></div>
		<div><h4>Purpose</h4>
<p>The LPA code generator is an endpoint used by Sirius and Use an LPA application to 
generate, validate and revoke codes so that actors, 
such as individuals with legal power of attorney over a donor, 
can validate their identity and gain access to view a donors details.</p>
<p>This is accomplished by Sirius sending out letters with unique codes to actors who can then 
try and validate the code through the use an LPA website.</p>
<h4>Consumers of this API</h4>
<ul>
<li>Sirius - <a href="https://github.com/ministryofjustice/opg-sirius">opg-sirius</a></li>
<li>Use an LPA - <a href="https://github.com/ministryofjustice/opg-use-an-lpa">opg-use-an-lpa</a></li>
</ul>
<h4>Integration Repositories</h4>
<ul>
<li>LPA Codes - <a href="https://github.com/ministryofjustice/opg-data-lpa-codes">opg-data-lpa-codes</a></li>
</ul>
<h4>Integration Location</h4>
<ul>
<li>Sirius Account (development, preproduction, production)</li>
<li>EU West 1</li>
</ul>
<h4>Security</h4>
<p>URLs to the endpoints are publicly accessible but locked down by AWS Authentication to only 
be accessible from the task ECS role of the API service for both Sirius and Use an LPA. </p>
<h4>Setup Local Environment</h4>
<p>From the root of the repository you can type <code>docker-compose up -d</code>. This will bring up two services, 
a connexion service (that mocks aws gateway validation and routes requests) and a dynamodb local service 
which acts as the data store.</p>
<h4>Setup Branch Environment</h4>
<p>Branch environments are set up through the CI pipeline. However if you wish to build one manually 
for whatever reason then you can run the following (replacing <myworkspace> with whatever you want 
your workspace to be called):</p>
<div class="highlight"><pre><span></span><code><span class="err">cd terraform/environment</span>
<span class="err">export TF_WORKSPACE=&lt;myworkspace&gt;</span>
<span class="err">aws-vault exec identity -- terraform init</span>
<span class="err">aws-vault exec identity -- terraform plan</span>
<span class="err">aws-vault exec identity -- terraform apply  </span>
</code></pre></div>


<p>More information on working with workspaces can be found in the technologies used tab.</p>
<h4>ADRs</h4>
<p>Can be found <a href="https://github.com/ministryofjustice/opg-data-lpa-codes/tree/master/docs/architecture/decisions">here</a> 
and <a href="https://github.com/ministryofjustice/opg-data/tree/master/docs/architecture">here</a>.</p>
<h4>Testing</h4>
<p>Testing is accomplished by using a combination of unit tests and contract testing (using pact).</p>
<p>Unit tests can be run locally by running the following from the root directory of the repo:</p>
<div class="highlight"><pre><span></span><code><span class="err">virtualenv venv</span>
<span class="err">source venv/bin/activate</span>
<span class="err">pip install -r ./lambda_functions/v1/requirements/dev-requirements.txt</span>
<span class="err">python -m pytest</span>
</code></pre></div>


<p>Pact tests can only be run against pact broker currently. Local verification.</p>
<h4>Design Documents</h4>
<p><a href="https://docs.google.com/drawings/d/1ghTX_lBpWcjYViPCzbbXQ0MRa2bcg2o0xf25GLSbAgI/edit">work in progress</a></p></div>
	</div>
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; Ministry of Justice</p>
		</footer>
	  </div>

	</div>
</body>
</html>